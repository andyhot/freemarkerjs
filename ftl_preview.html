<html>
	<head>
		<title>FM</title>
		<style>
			.red {background:red;}
			.green {background:green;}
		</style>
	</head>
<body>

	<div id="node1"> </div>
	<div id="node2"> </div>
	<div id="node3"> </div>
	<div id="node4"> </div>

	<script src="freemarker.js" type="text/javascript" id="Any_0"></script>        
    <script type="text/javascript">
	function doTemplate(template, context, node, expected) {
		var text = freemarker.render(template, context);
		//console.debug(text, expected);
		node = document.getElementById(node);
		node.innerHTML = text;	
		if (expected) {
			node.className = expected==text ? 'green' : 'red';
		}
	}
	var listTemplate1 = "<#list envelopes as envelope><div id=\"${envelope.id}\" class=\"amptpl_Block \">${envelope.title}"
	+"</div><#if tipLink??><br/><a href=\"${tipLink}\">If you like this, tip this!</a>&nbsp;</#if><#if "
	+"copyLink??><#if copyLinkOnClick??><a href=\"${copyLink}\" onclick=\"${copyLinkOnClick}\">copy"
	+" this!</a><#else><a href=\"${copyLink}\">copy this!</a></#if></#if><hr/></#list>";

	var expected1 = "<div id=\"1\" class=\"amptpl_Block \">Help</div><br/><a href=\"http://amplafi.net\">"
		+"If you like this, tip this!</a>&nbsp;<a href=\"opa\" onclick=\"1\">copy this!</a><hr/>"
		+"<div id=\"2\" class=\"amptpl_Block \">Hello</div><br/><a href=\"http://amplafi.net\">"
		+"If you like this, tip this!</a>&nbsp;<a href=\"opa\" onclick=\"1\">copy this!</a><hr/>";
 
 	doTemplate(listTemplate1, { copyLink:'opa', copyLinkOnClick:'1', tipLink:'http://amplafi.net', 
		envelopes:[{id:1, title:'Help'}, {id:2, title:'Hello'}] }, 'node1', expected1);
    </script>

</body>
</html>
